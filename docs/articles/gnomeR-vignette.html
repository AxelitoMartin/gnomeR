<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>gnomeR for IMPACT data • gnomeR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="gnomeR for IMPACT data">
<meta property="og:description" content="gnomeR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gnomeR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/gnomeR-vignette.html">gnomeR for IMPACT data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/AxelitoMartin/gnomeR/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="gnomeR-vignette_files/htmlwidgets-1.5.1/htmlwidgets.js"></script><script src="gnomeR-vignette_files/plotly-binding-4.9.2.1/plotly.js"></script><script src="gnomeR-vignette_files/typedarray-0.1/typedarray.min.js"></script><script src="gnomeR-vignette_files/jquery-1.11.3/jquery.min.js"></script><link href="gnomeR-vignette_files/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet">
<script src="gnomeR-vignette_files/crosstalk-1.1.0.1/js/crosstalk.min.js"></script><link href="gnomeR-vignette_files/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet">
<script src="gnomeR-vignette_files/plotly-main-1.52.2/plotly-latest.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>gnomeR for IMPACT data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/AxelitoMartin/gnomeR/blob/master/vignettes/gnomeR-vignette.Rmd"><code>vignettes/gnomeR-vignette.Rmd</code></a></small>
      <div class="hidden name"><code>gnomeR-vignette.Rmd</code></div>

    </div>

    
    
<div id="installation" class="section level1">
<h1 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h1>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"devtools"</span>)
<span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">"AxelitoMartin/gnomeR"</span>)</pre></body></html></div>
</div>
<div id="requirements" class="section level1">
<h1 class="hasAnchor">
<a href="#requirements" class="anchor"></a>Requirements</h1>
<p><i>gnomeR</i> requires the following packages - <code>ComplexHeatmap</code>, <code>iClusterPlus</code>, <code>cluster</code> (installed with gnomeR).</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">gnomeR</span>)</pre></body></html></div>
</div>
<div id="introduction" class="section level1 tabset tabset-fade tabset-pills">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p><i>gnomeR</i> is a R package that aims to process and analyze genetic data from cBioPortal. We include in this package the mutation, copy number alteration (CNA), fusion and clin.patientsical information of all publicly available data from cBioPortal.</p>
<div id="mutations" class="section level2">
<h2 class="hasAnchor">
<a href="#mutations" class="anchor"></a>Mutations</h2>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu">as.tbl</span>(<span class="no">mut</span>) <span class="kw">%&gt;%</span> <span class="fu">select</span>(<span class="no">Tumor_Sample_Barcode</span>,<span class="no">Hugo_Symbol</span>,<span class="no">Variant_Classification</span>,<span class="no">Variant_Type</span>,<span class="no">Reference_Allele</span>,<span class="no">Tumor_Seq_Allele2</span>)
<span class="co">#&gt; # A tibble: 3,179 x 6</span>
<span class="co">#&gt;    Tumor_Sample_Ba… Hugo_Symbol Variant_Classif… Variant_Type Reference_Allele</span>
<span class="co">#&gt;    &lt;fct&gt;            &lt;fct&gt;       &lt;fct&gt;            &lt;fct&gt;        &lt;fct&gt;           </span>
<span class="co">#&gt;  1 P-0000062-T01-I… TP53        Missense_Mutati… SNP          G               </span>
<span class="co">#&gt;  2 P-0000062-T01-I… EZH2        Missense_Mutati… SNP          G               </span>
<span class="co">#&gt;  3 P-0000062-T01-I… MDM2        Missense_Mutati… SNP          A               </span>
<span class="co">#&gt;  4 P-0000062-T01-I… IGF1R       Missense_Mutati… SNP          T               </span>
<span class="co">#&gt;  5 P-0000062-T01-I… KEAP1       Missense_Mutati… SNP          G               </span>
<span class="co">#&gt;  6 P-0000062-T01-I… KDM5C       Missense_Mutati… SNP          G               </span>
<span class="co">#&gt;  7 P-0000065-T01-I… KRAS        Missense_Mutati… SNP          C               </span>
<span class="co">#&gt;  8 P-0000065-T01-I… TERT        5'Flank          SNP          G               </span>
<span class="co">#&gt;  9 P-0000065-T01-I… MAP2K1      Missense_Mutati… SNP          T               </span>
<span class="co">#&gt; 10 P-0000065-T01-I… NCOR1       Nonsense_Mutati… SNP          C               </span>
<span class="co">#&gt; # … with 3,169 more rows, and 1 more variable: Tumor_Seq_Allele2 &lt;fct&gt;</span></pre></body></html></div>
</div>
<div id="cna" class="section level2">
<h2 class="hasAnchor">
<a href="#cna" class="anchor"></a>CNA</h2>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu">as.tbl</span>(<span class="no">cna</span>[<span class="fl">1</span>:<span class="fl">5</span>,<span class="fl">1</span>:<span class="fl">5</span>])
<span class="co">#&gt; # A tibble: 5 x 5</span>
<span class="co">#&gt;   Hugo_Symbol P.0001890.T01.I… P.0000569.T01.I… P.0000795.T01.I…</span>
<span class="co">#&gt;   &lt;fct&gt;                  &lt;int&gt;            &lt;int&gt;            &lt;int&gt;</span>
<span class="co">#&gt; 1 ABL1                       0                0                0</span>
<span class="co">#&gt; 2 ACVR1                      0                0                0</span>
<span class="co">#&gt; 3 AKT1                       0                0                0</span>
<span class="co">#&gt; 4 AKT2                       0                0                0</span>
<span class="co">#&gt; 5 AKT3                       0                0                0</span>
<span class="co">#&gt; # … with 1 more variable: P.0002060.T01.IM3 &lt;int&gt;</span></pre></body></html></div>
</div>
<div id="fusions" class="section level2">
<h2 class="hasAnchor">
<a href="#fusions" class="anchor"></a>Fusions</h2>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu">as.tbl</span>(<span class="no">fusion</span>) <span class="kw">%&gt;%</span> <span class="fu">select</span>(<span class="no">Tumor_Sample_Barcode</span>,<span class="no">Hugo_Symbol</span>,<span class="no">Fusion</span>)
<span class="co">#&gt; # A tibble: 127 x 3</span>
<span class="co">#&gt;    Tumor_Sample_Barcode Hugo_Symbol Fusion             </span>
<span class="co">#&gt;    &lt;fct&gt;                &lt;fct&gt;       &lt;fct&gt;              </span>
<span class="co">#&gt;  1 P-0010011-T01-IM5    PAX8        PAX8-intragenic    </span>
<span class="co">#&gt;  2 P-0010977-T01-IM5    TFE3        ASPSCR1-TFE3 fusion</span>
<span class="co">#&gt;  3 P-0010977-T01-IM5    ASPSCR1     ASPSCR1-TFE3 fusion</span>
<span class="co">#&gt;  4 P-0010398-T01-IM5    BRAF        OSBPL9-BRAF fusion </span>
<span class="co">#&gt;  5 P-0010398-T01-IM5    OSBPL9      OSBPL9-BRAF fusion </span>
<span class="co">#&gt;  6 P-0010177-T01-IM5    ALK         EML4-ALK fusion    </span>
<span class="co">#&gt;  7 P-0010177-T01-IM5    EML4        EML4-ALK fusion    </span>
<span class="co">#&gt;  8 P-0010604-T01-IM5    MLL3        MLL3-intragenic    </span>
<span class="co">#&gt;  9 P-0010794-T01-IM5    ERG         TMPRSS2-ERG fusion </span>
<span class="co">#&gt; 10 P-0010794-T01-IM5    TMPRSS2     TMPRSS2-ERG fusion </span>
<span class="co">#&gt; # … with 117 more rows</span></pre></body></html></div>
</div>
<div id="clinical" class="section level2">
<h2 class="hasAnchor">
<a href="#clinical" class="anchor"></a>Clinical</h2>
<div id="patients-information" class="section level3">
<h3 class="hasAnchor">
<a href="#patients-information" class="anchor"></a>Patients information</h3>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu">as.tbl</span>(<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">clin.patients</span>))
<span class="co">#&gt; # A tibble: 6 x 6</span>
<span class="co">#&gt;   X.Patient.Ident… Sex   Patient.s.Vital… Smoking.History Overall.Surviva…</span>
<span class="co">#&gt;   &lt;fct&gt;            &lt;fct&gt; &lt;fct&gt;            &lt;fct&gt;           &lt;fct&gt;           </span>
<span class="co">#&gt; 1 P-0000062        Male  DECEASED         Never           23.44           </span>
<span class="co">#&gt; 2 P-0000065        Fema… DECEASED         Prev/Curr Smok… 12.69           </span>
<span class="co">#&gt; 3 P-0000080        Fema… DECEASED         Never           &lt;NA&gt;            </span>
<span class="co">#&gt; 4 P-0000088        Male  DECEASED         Never           26.13           </span>
<span class="co">#&gt; 5 P-0000096        Male  DECEASED         Prev/Curr Smok… 17.62           </span>
<span class="co">#&gt; 6 P-0000113        Fema… ALIVE            Prev/Curr Smok… 31.85           </span>
<span class="co">#&gt; # … with 1 more variable: Overall.Survival.Status &lt;fct&gt;</span></pre></body></html></div>
</div>
<div id="samples-information" class="section level3">
<h3 class="hasAnchor">
<a href="#samples-information" class="anchor"></a>Samples information</h3>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu">as.tbl</span>(<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">clin.sample</span>))
<span class="co">#&gt; # A tibble: 6 x 16</span>
<span class="co">#&gt;   X.Patient.Ident… Sample.Identifi… Sample.Collecti… Specimen.Preser…</span>
<span class="co">#&gt;   &lt;fct&gt;            &lt;fct&gt;            &lt;fct&gt;            &lt;fct&gt;           </span>
<span class="co">#&gt; 1 P-0002656        P-0002656-T01-I… Outside          FFPE            </span>
<span class="co">#&gt; 2 P-0001680        P-0001680-T02-I… Outside          FFPE            </span>
<span class="co">#&gt; 3 P-0001741        P-0001741-T01-I… Outside          FFPE            </span>
<span class="co">#&gt; 4 P-0002640        P-0002640-T01-I… Outside          FFPE            </span>
<span class="co">#&gt; 5 P-0002091        P-0002091-T01-I… In-House         FFPE            </span>
<span class="co">#&gt; 6 P-0001197        P-0001197-T01-I… Outside          FFPE            </span>
<span class="co">#&gt; # … with 12 more variables: Specimen.Type &lt;fct&gt;, DNA.Input &lt;fct&gt;,</span>
<span class="co">#&gt; #   Sample.coverage &lt;fct&gt;, Tumor.Purity &lt;fct&gt;, Matched.Status &lt;fct&gt;,</span>
<span class="co">#&gt; #   Sample.Type &lt;fct&gt;, Primary.Tumor.Site &lt;fct&gt;, Metastatic.Site &lt;fct&gt;,</span>
<span class="co">#&gt; #   Sample.Class &lt;fct&gt;, Oncotree.Code &lt;fct&gt;, Cancer.Type &lt;fct&gt;,</span>
<span class="co">#&gt; #   Cancer.Type.Detailed &lt;fct&gt;</span></pre></body></html></div>
</div>
</div>
</div>
<div id="maf-processing" class="section level1">
<h1 class="hasAnchor">
<a href="#maf-processing" class="anchor"></a>MAF processing</h1>
<p>MAF files are the standard file format for mutation information. Each line represents a single mutation mapped to a sample, a particular gene and specific effect. All these fields are required in order to properly process the file. The IMPACT platform sequences a set of targeted oncogenic genes that are on cBioportal.</p>
<div id="creating-a-binary-matrix" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-a-binary-matrix" class="anchor"></a>Creating a binary matrix</h2>
<p>We can create a binary matrix of genetic events from the files described above. If a patient has a mutation in gene X the entry will be marked with a 1, otherwise it will be a 0. This function has the following arguments:</p>
<ul>
<li>patients : a character vector of sample IDs to be matched in the MAF file. Default is NULL in which case all samples will be used.</li>
<li>maf : the corresponding MAF file (required)</li>
<li>mut.type : the mutation type to be used, options are “SOMATIC”, “GERMLINE” or “ALL”. Default is “SOMATIC”</li>
<li>SNP.only : boolean specifying if only SNPs should be used. Default is F</li>
<li>include.silent : boolean specifying if silent mutations should be included. Default is F (recommended)</li>
<li>fusion : optional fusion file to be included. Fusions will be added as their own column with “.fus” suffix</li>
<li>cna : optional copy number alteration file to be included. CNAs will be added as their column with “.Amp” suffix for amplifications and “.Del” suffix for deletions</li>
<li>cna.relax : boolean specifying if shallow deletions and low level gains should be counted as deletions and amplifications respectively</li>
<li>spe.plat : boolean specifying if specific IMPACT platforms should be considered. When TRUE NAs will fill the cells for genes of patients that were not sequenced on that plaform</li>
<li>set.plat : character argument specifying which IMPACT platform the data should be reduced to if spe.plat is set to TRUE. Options are “341” and “410”. Default is NULL.</li>
<li>rm.empty : boolean specifying if columns with no events founds should be removed. Default is TRUE.</li>
</ul>
<p>This function will return a binary matrix of genetics events with patients as rows and columns as genes. Along with a list of patients that weren’t found to have any events (if any).</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">patients</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="no">mut</span>$<span class="no">Tumor_Sample_Barcode</span>))[<span class="fl">1</span>:<span class="fl">200</span>]
<span class="no">bin.mut</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/binmat.html">binmat</a></span>(<span class="kw">patients</span> <span class="kw">=</span> <span class="no">patients</span>,<span class="kw">maf</span> <span class="kw">=</span> <span class="no">mut</span>,<span class="kw">mut.type</span> <span class="kw">=</span> <span class="st">"SOMATIC"</span>,<span class="kw">SNP.only</span> <span class="kw">=</span> <span class="fl">FALSE</span>,<span class="kw">include.silent</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">spe.plat</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="fu">as.tbl</span>(<span class="no">bin.mut</span>)
<span class="co">#&gt; # A tibble: 200 x 275</span>
<span class="co">#&gt;     TP53  EZH2  MDM2 IGF1R KEAP1 KDM5C  KRAS  TERT MAP2K1 NCOR1  DDR2  IDH1</span>
<span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1     1     1     1     1     1     1     0     0      0     0     0     0</span>
<span class="co">#&gt;  2     0     0     0     0     0     0     1     1      1     1     0     0</span>
<span class="co">#&gt;  3     1     0     0     0     0     0     0     0      0     0     1     1</span>
<span class="co">#&gt;  4     0     0     0     0     0     0     0     0      0     0     0     0</span>
<span class="co">#&gt;  5     1     0     0     0     0     0     0     0      0     0     0     0</span>
<span class="co">#&gt;  6     0     0     0     0     0     1     1     0      0     1     0     0</span>
<span class="co">#&gt;  7     1     0     0     0     0     0     1     0      0     0     0     0</span>
<span class="co">#&gt;  8     1     0     0     1     0     0     0     1      0     0     0     0</span>
<span class="co">#&gt;  9     0     0     0     0     0     0     0     0      0     0     0     0</span>
<span class="co">#&gt; 10     1     0     0     0     0     0     0     0      0     0     0     0</span>
<span class="co">#&gt; # … with 190 more rows, and 263 more variables: FIP1L1 &lt;dbl&gt;, EPHA5 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   RASA1 &lt;dbl&gt;, RAD50 &lt;dbl&gt;, ESR1 &lt;dbl&gt;, HGF &lt;dbl&gt;, MLL3 &lt;dbl&gt;, RET &lt;dbl&gt;,</span>
<span class="co">#&gt; #   FLT1 &lt;dbl&gt;, BRCA2 &lt;dbl&gt;, RB1 &lt;dbl&gt;, PTPRT &lt;dbl&gt;, AR &lt;dbl&gt;, FOXL2 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   FLT4 &lt;dbl&gt;, PIK3CA &lt;dbl&gt;, EP300 &lt;dbl&gt;, FBXW7 &lt;dbl&gt;, MPL &lt;dbl&gt;, RIT1 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   NTRK1 &lt;dbl&gt;, FAT1 &lt;dbl&gt;, RICTOR &lt;dbl&gt;, TNFAIP3 &lt;dbl&gt;, ARID1B &lt;dbl&gt;,</span>
<span class="co">#&gt; #   GNAQ &lt;dbl&gt;, SYK &lt;dbl&gt;, TSC1 &lt;dbl&gt;, NOTCH1 &lt;dbl&gt;, PAK1 &lt;dbl&gt;, MLL2 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   POLE &lt;dbl&gt;, TRAF7 &lt;dbl&gt;, NF1 &lt;dbl&gt;, GNA11 &lt;dbl&gt;, INSR &lt;dbl&gt;, AXL &lt;dbl&gt;,</span>
<span class="co">#&gt; #   ERG &lt;dbl&gt;, ARID1A &lt;dbl&gt;, MLH1 &lt;dbl&gt;, EGFR &lt;dbl&gt;, TBX3 &lt;dbl&gt;, MDC1 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   RECQL4 &lt;dbl&gt;, SPEN &lt;dbl&gt;, NTRK2 &lt;dbl&gt;, STAG2 &lt;dbl&gt;, CREBBP &lt;dbl&gt;,</span>
<span class="co">#&gt; #   AKT1 &lt;dbl&gt;, CTNNB1 &lt;dbl&gt;, PDPK1 &lt;dbl&gt;, CTCF &lt;dbl&gt;, CDH1 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   PPP2R1A &lt;dbl&gt;, CCND1 &lt;dbl&gt;, RUNX1 &lt;dbl&gt;, CARD11 &lt;dbl&gt;, ARID5B &lt;dbl&gt;,</span>
<span class="co">#&gt; #   ERBB2 &lt;dbl&gt;, BCOR &lt;dbl&gt;, BRAF &lt;dbl&gt;, ATM &lt;dbl&gt;, MTOR &lt;dbl&gt;, STK40 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   SPOP &lt;dbl&gt;, RAF1 &lt;dbl&gt;, MAP3K13 &lt;dbl&gt;, BRCA1 &lt;dbl&gt;, CIC &lt;dbl&gt;,</span>
<span class="co">#&gt; #   RPS6KA4 &lt;dbl&gt;, AKT3 &lt;dbl&gt;, NTRK3 &lt;dbl&gt;, ATRX &lt;dbl&gt;, PBRM1 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   ASXL2 &lt;dbl&gt;, SF3B1 &lt;dbl&gt;, PIK3CB &lt;dbl&gt;, TET2 &lt;dbl&gt;, CDKN2B &lt;dbl&gt;,</span>
<span class="co">#&gt; #   MRE11A &lt;dbl&gt;, CBL &lt;dbl&gt;, TSHR &lt;dbl&gt;, BLM &lt;dbl&gt;, CBFB &lt;dbl&gt;, DOT1L &lt;dbl&gt;,</span>
<span class="co">#&gt; #   RBM10 &lt;dbl&gt;, SMAD3 &lt;dbl&gt;, CDK8 &lt;dbl&gt;, GATA2 &lt;dbl&gt;, STK11 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   SMARCA4 &lt;dbl&gt;, PIK3C2G &lt;dbl&gt;, HIST1H3B &lt;dbl&gt;, MYOD1 &lt;dbl&gt;, APC &lt;dbl&gt;,</span>
<span class="co">#&gt; #   EPHA3 &lt;dbl&gt;, ETV6 &lt;dbl&gt;, PTCH1 &lt;dbl&gt;, TET1 &lt;dbl&gt;, BMPR1A &lt;dbl&gt;, …</span></pre></body></html></div>
<p>Similarly including fusions and CNAs:</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">bin.mut</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/binmat.html">binmat</a></span>(<span class="kw">patients</span> <span class="kw">=</span> <span class="no">patients</span>,<span class="kw">maf</span> <span class="kw">=</span> <span class="no">mut</span>,<span class="kw">mut.type</span> <span class="kw">=</span> <span class="st">"SOMATIC"</span>,<span class="kw">SNP.only</span> <span class="kw">=</span> <span class="fl">FALSE</span>,<span class="kw">include.silent</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">fusion</span> <span class="kw">=</span> <span class="no">fusion</span>, <span class="kw">cna</span> <span class="kw">=</span> <span class="no">cna</span>, <span class="kw">spe.plat</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="fu">as.tbl</span>(<span class="no">bin.mut</span>)
<span class="co">#&gt; # A tibble: 200 x 522</span>
<span class="co">#&gt;     TP53  EZH2  MDM2 IGF1R KEAP1 KDM5C  KRAS  TERT MAP2K1 NCOR1  DDR2  IDH1</span>
<span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1     1     1     1     1     1     1     0     0      0     0     0     0</span>
<span class="co">#&gt;  2     0     0     0     0     0     0     1     1      1     1     0     0</span>
<span class="co">#&gt;  3     1     0     0     0     0     0     0     0      0     0     1     1</span>
<span class="co">#&gt;  4     0     0     0     0     0     0     0     0      0     0     0     0</span>
<span class="co">#&gt;  5     1     0     0     0     0     0     0     0      0     0     0     0</span>
<span class="co">#&gt;  6     0     0     0     0     0     1     1     0      0     1     0     0</span>
<span class="co">#&gt;  7     1     0     0     0     0     0     1     0      0     0     0     0</span>
<span class="co">#&gt;  8     1     0     0     1     0     0     0     1      0     0     0     0</span>
<span class="co">#&gt;  9     0     0     0     0     0     0     0     0      0     0     0     0</span>
<span class="co">#&gt; 10     1     0     0     0     0     0     0     0      0     0     0     0</span>
<span class="co">#&gt; # … with 190 more rows, and 510 more variables: FIP1L1 &lt;dbl&gt;, EPHA5 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   RASA1 &lt;dbl&gt;, RAD50 &lt;dbl&gt;, ESR1 &lt;dbl&gt;, HGF &lt;dbl&gt;, MLL3 &lt;dbl&gt;, RET &lt;dbl&gt;,</span>
<span class="co">#&gt; #   FLT1 &lt;dbl&gt;, BRCA2 &lt;dbl&gt;, RB1 &lt;dbl&gt;, PTPRT &lt;dbl&gt;, AR &lt;dbl&gt;, FOXL2 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   FLT4 &lt;dbl&gt;, PIK3CA &lt;dbl&gt;, EP300 &lt;dbl&gt;, FBXW7 &lt;dbl&gt;, MPL &lt;dbl&gt;, RIT1 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   NTRK1 &lt;dbl&gt;, FAT1 &lt;dbl&gt;, RICTOR &lt;dbl&gt;, TNFAIP3 &lt;dbl&gt;, ARID1B &lt;dbl&gt;,</span>
<span class="co">#&gt; #   GNAQ &lt;dbl&gt;, SYK &lt;dbl&gt;, TSC1 &lt;dbl&gt;, NOTCH1 &lt;dbl&gt;, PAK1 &lt;dbl&gt;, MLL2 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   POLE &lt;dbl&gt;, TRAF7 &lt;dbl&gt;, NF1 &lt;dbl&gt;, GNA11 &lt;dbl&gt;, INSR &lt;dbl&gt;, AXL &lt;dbl&gt;,</span>
<span class="co">#&gt; #   ERG &lt;dbl&gt;, ARID1A &lt;dbl&gt;, MLH1 &lt;dbl&gt;, EGFR &lt;dbl&gt;, TBX3 &lt;dbl&gt;, MDC1 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   RECQL4 &lt;dbl&gt;, SPEN &lt;dbl&gt;, NTRK2 &lt;dbl&gt;, STAG2 &lt;dbl&gt;, CREBBP &lt;dbl&gt;,</span>
<span class="co">#&gt; #   AKT1 &lt;dbl&gt;, CTNNB1 &lt;dbl&gt;, PDPK1 &lt;dbl&gt;, CTCF &lt;dbl&gt;, CDH1 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   PPP2R1A &lt;dbl&gt;, CCND1 &lt;dbl&gt;, RUNX1 &lt;dbl&gt;, CARD11 &lt;dbl&gt;, ARID5B &lt;dbl&gt;,</span>
<span class="co">#&gt; #   ERBB2 &lt;dbl&gt;, BCOR &lt;dbl&gt;, BRAF &lt;dbl&gt;, ATM &lt;dbl&gt;, MTOR &lt;dbl&gt;, STK40 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   SPOP &lt;dbl&gt;, RAF1 &lt;dbl&gt;, MAP3K13 &lt;dbl&gt;, BRCA1 &lt;dbl&gt;, CIC &lt;dbl&gt;,</span>
<span class="co">#&gt; #   RPS6KA4 &lt;dbl&gt;, AKT3 &lt;dbl&gt;, NTRK3 &lt;dbl&gt;, ATRX &lt;dbl&gt;, PBRM1 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   ASXL2 &lt;dbl&gt;, SF3B1 &lt;dbl&gt;, PIK3CB &lt;dbl&gt;, TET2 &lt;dbl&gt;, CDKN2B &lt;dbl&gt;,</span>
<span class="co">#&gt; #   MRE11A &lt;dbl&gt;, CBL &lt;dbl&gt;, TSHR &lt;dbl&gt;, BLM &lt;dbl&gt;, CBFB &lt;dbl&gt;, DOT1L &lt;dbl&gt;,</span>
<span class="co">#&gt; #   RBM10 &lt;dbl&gt;, SMAD3 &lt;dbl&gt;, CDK8 &lt;dbl&gt;, GATA2 &lt;dbl&gt;, STK11 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   SMARCA4 &lt;dbl&gt;, PIK3C2G &lt;dbl&gt;, HIST1H3B &lt;dbl&gt;, MYOD1 &lt;dbl&gt;, APC &lt;dbl&gt;,</span>
<span class="co">#&gt; #   EPHA3 &lt;dbl&gt;, ETV6 &lt;dbl&gt;, PTCH1 &lt;dbl&gt;, TET1 &lt;dbl&gt;, BMPR1A &lt;dbl&gt;, …</span></pre></body></html></div>
</div>
<div id="visualizing-genetics" class="section level2">
<h2 class="hasAnchor">
<a href="#visualizing-genetics" class="anchor"></a>Visualizing genetics</h2>
<p>We include a function to visualize summaries of the mutations in a given cohort:</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="../reference/maf.summary.html">maf.summary</a></span>(<span class="kw">maf</span> <span class="kw">=</span> <span class="no">mut</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">Tumor_Sample_Barcode</span> <span class="kw">%in%</span> <span class="no">patients</span>),
            <span class="kw">mut.type</span> <span class="kw">=</span> <span class="st">"SOMATIC"</span>)
<span class="co">#&gt; $p.class</span></pre></body></html></div>
<p><img src="gnomeR-vignette_files/figure-html/unnamed-chunk-11-1.png" width="768"></p>
<pre><code>#&gt; 
#&gt; $p.type</code></pre>
<p><img src="gnomeR-vignette_files/figure-html/unnamed-chunk-11-2.png" width="768"></p>
<pre><code>#&gt; 
#&gt; $p.SNV</code></pre>
<p><img src="gnomeR-vignette_files/figure-html/unnamed-chunk-11-3.png" width="768"></p>
<pre><code>#&gt; 
#&gt; $p.patient.variant</code></pre>
<p><img src="gnomeR-vignette_files/figure-html/unnamed-chunk-11-4.png" width="768"></p>
<pre><code>#&gt; 
#&gt; $p.variant.bp</code></pre>
<p><img src="gnomeR-vignette_files/figure-html/unnamed-chunk-11-5.png" width="768"></p>
<pre><code>#&gt; 
#&gt; $p.genes</code></pre>
<p><img src="gnomeR-vignette_files/figure-html/unnamed-chunk-11-6.png" width="768"></p>
<pre><code>#&gt; 
#&gt; $p.variant.dist</code></pre>
<p><img src="gnomeR-vignette_files/figure-html/unnamed-chunk-11-7.png" width="768"></p>
<pre><code>#&gt; 
#&gt; $p.variant.dist.bar</code></pre>
<p><img src="gnomeR-vignette_files/figure-html/unnamed-chunk-11-8.png" width="768"></p>
<pre><code>#&gt; 
#&gt; $p.SNV.dist</code></pre>
<p><img src="gnomeR-vignette_files/figure-html/unnamed-chunk-11-9.png" width="768"></p>
<pre><code>#&gt; 
#&gt; $p.corr</code></pre>
<p><img src="gnomeR-vignette_files/figure-html/unnamed-chunk-11-10.png" width="768"></p>
<pre><code>#&gt; 
#&gt; $p.comut</code></pre>
<p><img src="gnomeR-vignette_files/figure-html/unnamed-chunk-11-11.png" width="768"></p>
</div>
</div>
<div id="correlating-genetics-with-outcome" class="section level1">
<h1 class="hasAnchor">
<a href="#correlating-genetics-with-outcome" class="anchor"></a>Correlating genetics with outcome</h1>
<div id="binary-outcome" class="section level2">
<h2 class="hasAnchor">
<a href="#binary-outcome" class="anchor"></a>Binary outcome</h2>
<p>The <code>gen.tab</code> function allows us to test for potential differences in genetic event frequencies using Fisher’s exact test for unpaired data and the McNemar exact test for paired data. This function takes the following arguments:</p>
<ul>
<li>gen.dat : a binary matrix of genetic events with patients as rows and columns as genes</li>
<li>outcome : a binary vector corresponding to the patients in the gen.dat argument</li>
<li>filter : a value in [0,1) that will remove all genes that have a frequency below that threshold. Default is 0, including all</li>
<li>paired : boolean specifying is the observations are paired. Default is false</li>
<li>cont : boolean specifying if the outcome is continuous. Default is false (see following section for an example)</li>
<li>rank : boolean specifying if the output table should be ranked by pvalue</li>
</ul>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="no">outcome</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">clin.sample</span>$<span class="no">Sample.Type</span>[<span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span>(<span class="no">patients</span>,<span class="no">clin.sample</span>$<span class="no">Sample.Identifier</span>)])
<span class="no">gen.dat</span> <span class="kw">&lt;-</span> <span class="no">bin.mut</span>
<span class="no">bin.test</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/gen.tab.html">gen.tab</a></span>(<span class="kw">gen.dat</span> <span class="kw">=</span> <span class="no">gen.dat</span>,
        <span class="kw">outcome</span> <span class="kw">=</span> <span class="no">outcome</span>,
        <span class="kw">filter</span> <span class="kw">=</span> <span class="fl">0.05</span>,<span class="kw">paired</span> <span class="kw">=</span> <span class="no">F</span>,<span class="kw">cont</span> <span class="kw">=</span> <span class="no">F</span>,<span class="kw">rank</span> <span class="kw">=</span> <span class="no">T</span>)
<span class="fu">kable</span>(<span class="no">bin.test</span>$<span class="no">fits</span>,<span class="kw">row.names</span> <span class="kw">=</span> <span class="no">T</span>)</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="left">Overall</th>
<th align="left">Metastasis(N=94)</th>
<th align="left">Primary(N=106)</th>
<th align="left">OddsRatio</th>
<th align="left">Pvalue</th>
<th align="left">Lower</th>
<th align="left">Upper</th>
<th align="left">FDR</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>MYC.Amp</td>
<td align="left">5%</td>
<td align="left">9.57%</td>
<td align="left">0.94%</td>
<td align="left">0.09</td>
<td align="left">6.84e-03</td>
<td align="left">0</td>
<td align="left">0.68</td>
<td align="left">1.78e-01</td>
</tr>
<tr class="even">
<td>CREBBP</td>
<td align="left">5%</td>
<td align="left">8.51%</td>
<td align="left">1.89%</td>
<td align="left">0.21</td>
<td align="left">4.82e-02</td>
<td align="left">0.02</td>
<td align="left">1.08</td>
<td align="left">5.49e-01</td>
</tr>
<tr class="odd">
<td>CDKN2A.Del</td>
<td align="left">5.5%</td>
<td align="left">2.13%</td>
<td align="left">8.49%</td>
<td align="left">4.24</td>
<td align="left">6.34e-02</td>
<td align="left">0.85</td>
<td align="left">41.39</td>
<td align="left">5.49e-01</td>
</tr>
<tr class="even">
<td>FAT1</td>
<td align="left">8%</td>
<td align="left">11.7%</td>
<td align="left">4.72%</td>
<td align="left">0.38</td>
<td align="left">1.15e-01</td>
<td align="left">0.1</td>
<td align="left">1.23</td>
<td align="left">5.94e-01</td>
</tr>
<tr class="odd">
<td>CCND1.Amp</td>
<td align="left">5.5%</td>
<td align="left">8.51%</td>
<td align="left">2.83%</td>
<td align="left">0.31</td>
<td align="left">1.19e-01</td>
<td align="left">0.05</td>
<td align="left">1.36</td>
<td align="left">5.94e-01</td>
</tr>
<tr class="even">
<td>EGFR</td>
<td align="left">8.5%</td>
<td align="left">11.7%</td>
<td align="left">5.66%</td>
<td align="left">0.45</td>
<td align="left">1.37e-01</td>
<td align="left">0.13</td>
<td align="left">1.41</td>
<td align="left">5.94e-01</td>
</tr>
<tr class="odd">
<td>BRAF</td>
<td align="left">5%</td>
<td align="left">7.45%</td>
<td align="left">2.83%</td>
<td align="left">0.36</td>
<td align="left">1.95e-01</td>
<td align="left">0.06</td>
<td align="left">1.65</td>
<td align="left">7.24e-01</td>
</tr>
<tr class="even">
<td>ARID1A</td>
<td align="left">7%</td>
<td align="left">9.57%</td>
<td align="left">4.72%</td>
<td align="left">0.47</td>
<td align="left">2.67e-01</td>
<td align="left">0.12</td>
<td align="left">1.63</td>
<td align="left">8.37e-01</td>
</tr>
<tr class="odd">
<td>ATRX</td>
<td align="left">7.5%</td>
<td align="left">5.32%</td>
<td align="left">9.43%</td>
<td align="left">1.85</td>
<td align="left">2.97e-01</td>
<td align="left">0.55</td>
<td align="left">7.17</td>
<td align="left">8.37e-01</td>
</tr>
<tr class="even">
<td>PTEN</td>
<td align="left">5%</td>
<td align="left">3.19%</td>
<td align="left">6.6%</td>
<td align="left">2.14</td>
<td align="left">3.40e-01</td>
<td align="left">0.47</td>
<td align="left">13.19</td>
<td align="left">8.37e-01</td>
</tr>
<tr class="odd">
<td>CDKN2A</td>
<td align="left">5.5%</td>
<td align="left">7.45%</td>
<td align="left">3.77%</td>
<td align="left">0.49</td>
<td align="left">3.54e-01</td>
<td align="left">0.1</td>
<td align="left">2</td>
<td align="left">8.37e-01</td>
</tr>
<tr class="even">
<td>SMARCA4</td>
<td align="left">5%</td>
<td align="left">6.38%</td>
<td align="left">3.77%</td>
<td align="left">0.58</td>
<td align="left">5.21e-01</td>
<td align="left">0.12</td>
<td align="left">2.52</td>
<td align="left">1.00e+00</td>
</tr>
<tr class="odd">
<td>MLL2</td>
<td align="left">7%</td>
<td align="left">8.51%</td>
<td align="left">5.66%</td>
<td align="left">0.65</td>
<td align="left">5.80e-01</td>
<td align="left">0.18</td>
<td align="left">2.22</td>
<td align="left">1.00e+00</td>
</tr>
<tr class="even">
<td>TP53</td>
<td align="left">47%</td>
<td align="left">48.94%</td>
<td align="left">45.28%</td>
<td align="left">0.86</td>
<td align="left">6.71e-01</td>
<td align="left">0.48</td>
<td align="left">1.56</td>
<td align="left">1.00e+00</td>
</tr>
<tr class="odd">
<td>TERT</td>
<td align="left">13.5%</td>
<td align="left">14.89%</td>
<td align="left">12.26%</td>
<td align="left">0.8</td>
<td align="left">6.80e-01</td>
<td align="left">0.32</td>
<td align="left">1.96</td>
<td align="left">1.00e+00</td>
</tr>
<tr class="even">
<td>ATM</td>
<td align="left">5%</td>
<td align="left">4.26%</td>
<td align="left">5.66%</td>
<td align="left">1.35</td>
<td align="left">7.52e-01</td>
<td align="left">0.31</td>
<td align="left">6.71</td>
<td align="left">1.00e+00</td>
</tr>
<tr class="odd">
<td>MLL3</td>
<td align="left">6.5%</td>
<td align="left">7.45%</td>
<td align="left">5.66%</td>
<td align="left">0.75</td>
<td align="left">7.75e-01</td>
<td align="left">0.2</td>
<td align="left">2.71</td>
<td align="left">1.00e+00</td>
</tr>
<tr class="even">
<td>MCL1.Amp</td>
<td align="left">6.5%</td>
<td align="left">7.45%</td>
<td align="left">5.66%</td>
<td align="left">0.75</td>
<td align="left">7.75e-01</td>
<td align="left">0.2</td>
<td align="left">2.71</td>
<td align="left">1.00e+00</td>
</tr>
<tr class="odd">
<td>APC</td>
<td align="left">8.5%</td>
<td align="left">7.45%</td>
<td align="left">9.43%</td>
<td align="left">1.29</td>
<td align="left">8.00e-01</td>
<td align="left">0.42</td>
<td align="left">4.19</td>
<td align="left">1.00e+00</td>
</tr>
<tr class="even">
<td>KRAS</td>
<td align="left">13.5%</td>
<td align="left">12.77%</td>
<td align="left">14.15%</td>
<td align="left">1.13</td>
<td align="left">8.38e-01</td>
<td align="left">0.46</td>
<td align="left">2.8</td>
<td align="left">1.00e+00</td>
</tr>
<tr class="odd">
<td>KEAP1</td>
<td align="left">6%</td>
<td align="left">6.38%</td>
<td align="left">5.66%</td>
<td align="left">0.88</td>
<td align="left">1.00e+00</td>
<td align="left">0.23</td>
<td align="left">3.42</td>
<td align="left">1.00e+00</td>
</tr>
<tr class="even">
<td>RB1</td>
<td align="left">7%</td>
<td align="left">7.45%</td>
<td align="left">6.6%</td>
<td align="left">0.88</td>
<td align="left">1.00e+00</td>
<td align="left">0.25</td>
<td align="left">3.07</td>
<td align="left">1.00e+00</td>
</tr>
<tr class="odd">
<td>PIK3CA</td>
<td align="left">11.5%</td>
<td align="left">11.7%</td>
<td align="left">11.32%</td>
<td align="left">0.96</td>
<td align="left">1.00e+00</td>
<td align="left">0.37</td>
<td align="left">2.55</td>
<td align="left">1.00e+00</td>
</tr>
<tr class="even">
<td>NOTCH1</td>
<td align="left">6.5%</td>
<td align="left">6.38%</td>
<td align="left">6.6%</td>
<td align="left">1.04</td>
<td align="left">1.00e+00</td>
<td align="left">0.29</td>
<td align="left">3.89</td>
<td align="left">1.00e+00</td>
</tr>
<tr class="odd">
<td>NF1</td>
<td align="left">7%</td>
<td align="left">7.45%</td>
<td align="left">6.6%</td>
<td align="left">0.88</td>
<td align="left">1.00e+00</td>
<td align="left">0.25</td>
<td align="left">3.07</td>
<td align="left">1.00e+00</td>
</tr>
<tr class="even">
<td>STK11</td>
<td align="left">6%</td>
<td align="left">6.38%</td>
<td align="left">5.66%</td>
<td align="left">0.88</td>
<td align="left">1.00e+00</td>
<td align="left">0.23</td>
<td align="left">3.42</td>
<td align="left">1.00e+00</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="no">bin.test</span>$<span class="no">forest.plot</span></pre></body></html></div>
<p><img src="gnomeR-vignette_files/figure-html/unnamed-chunk-12-1.png" width="768"></p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="no">bin.test</span>$<span class="no">vPlot</span></pre></body></html></div>
<p><img src="gnomeR-vignette_files/figure-html/unnamed-chunk-12-2.png" width="768"></p>
</div>
<div id="continuous-outcome" class="section level2">
<h2 class="hasAnchor">
<a href="#continuous-outcome" class="anchor"></a>Continuous outcome</h2>
<p>Similarly we show here an example with a simulated continuous outcome:</p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">1</span>)
<span class="no">outcome</span> <span class="kw">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="kw">n</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">gen.dat</span>))
<span class="no">tab.out</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/gen.tab.html">gen.tab</a></span>(<span class="kw">gen.dat</span> <span class="kw">=</span> <span class="no">gen.dat</span>,
        <span class="kw">outcome</span> <span class="kw">=</span> <span class="no">outcome</span>,
        <span class="kw">filter</span> <span class="kw">=</span> <span class="fl">0.05</span>,<span class="kw">paired</span> <span class="kw">=</span> <span class="no">F</span>,<span class="kw">cont</span> <span class="kw">=</span> <span class="no">T</span>,<span class="kw">rank</span> <span class="kw">=</span> <span class="no">T</span>)
<span class="fu">kable</span>(<span class="no">tab.out</span>$<span class="no">fits</span>,<span class="kw">row.names</span> <span class="kw">=</span> <span class="no">T</span>)</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="right">Estimate</th>
<th align="right">SD</th>
<th align="right">Pvalue</th>
<th align="right">MutationFreq</th>
<th align="right">FDR</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>CREBBP</td>
<td align="right">0.7064531</td>
<td align="right">0.2979996</td>
<td align="right">0.0187170</td>
<td align="right">0.050</td>
<td align="right">0.4866429</td>
</tr>
<tr class="even">
<td>RB1</td>
<td align="right">-0.5045771</td>
<td align="right">0.2556339</td>
<td align="right">0.0497921</td>
<td align="right">0.070</td>
<td align="right">0.6190481</td>
</tr>
<tr class="odd">
<td>BRAF</td>
<td align="right">0.5432385</td>
<td align="right">0.2997231</td>
<td align="right">0.0714286</td>
<td align="right">0.050</td>
<td align="right">0.6190481</td>
</tr>
<tr class="even">
<td>STK11</td>
<td align="right">-0.3927698</td>
<td align="right">0.2759241</td>
<td align="right">0.1561737</td>
<td align="right">0.060</td>
<td align="right">0.8294738</td>
</tr>
<tr class="odd">
<td>KEAP1</td>
<td align="right">-0.3790557</td>
<td align="right">0.2760210</td>
<td align="right">0.1712166</td>
<td align="right">0.060</td>
<td align="right">0.8294738</td>
</tr>
<tr class="even">
<td>TERT</td>
<td align="right">0.2515656</td>
<td align="right">0.1919061</td>
<td align="right">0.1914170</td>
<td align="right">0.135</td>
<td align="right">0.8294738</td>
</tr>
<tr class="odd">
<td>MCL1.Amp</td>
<td align="right">-0.3017580</td>
<td align="right">0.2663017</td>
<td align="right">0.2585244</td>
<td align="right">0.065</td>
<td align="right">0.9602334</td>
</tr>
<tr class="even">
<td>CCND1.Amp</td>
<td align="right">-0.2713670</td>
<td align="right">0.2882525</td>
<td align="right">0.3476362</td>
<td align="right">0.055</td>
<td align="right">0.9711260</td>
</tr>
<tr class="odd">
<td>FAT1</td>
<td align="right">0.2075736</td>
<td align="right">0.2423249</td>
<td align="right">0.3927058</td>
<td align="right">0.080</td>
<td align="right">0.9711260</td>
</tr>
<tr class="even">
<td>SMARCA4</td>
<td align="right">-0.2392014</td>
<td align="right">0.3017207</td>
<td align="right">0.4288487</td>
<td align="right">0.050</td>
<td align="right">0.9711260</td>
</tr>
<tr class="odd">
<td>APC</td>
<td align="right">0.1556627</td>
<td align="right">0.2359083</td>
<td align="right">0.5101207</td>
<td align="right">0.085</td>
<td align="right">0.9711260</td>
</tr>
<tr class="even">
<td>NF1</td>
<td align="right">0.1608545</td>
<td align="right">0.2578834</td>
<td align="right">0.5335103</td>
<td align="right">0.070</td>
<td align="right">0.9711260</td>
</tr>
<tr class="odd">
<td>EGFR</td>
<td align="right">-0.1443205</td>
<td align="right">0.2359447</td>
<td align="right">0.5414573</td>
<td align="right">0.085</td>
<td align="right">0.9711260</td>
</tr>
<tr class="even">
<td>ATM</td>
<td align="right">-0.1779169</td>
<td align="right">0.3019346</td>
<td align="right">0.5563610</td>
<td align="right">0.050</td>
<td align="right">0.9711260</td>
</tr>
<tr class="odd">
<td>MLL3</td>
<td align="right">-0.1526306</td>
<td align="right">0.2669435</td>
<td align="right">0.5681255</td>
<td align="right">0.065</td>
<td align="right">0.9711260</td>
</tr>
<tr class="even">
<td>ATRX</td>
<td align="right">-0.1119015</td>
<td align="right">0.2499303</td>
<td align="right">0.6548370</td>
<td align="right">0.075</td>
<td align="right">0.9711260</td>
</tr>
<tr class="odd">
<td>PTEN</td>
<td align="right">-0.1295196</td>
<td align="right">0.3020590</td>
<td align="right">0.6685429</td>
<td align="right">0.050</td>
<td align="right">0.9711260</td>
</tr>
<tr class="even">
<td>CDKN2A</td>
<td align="right">0.1223210</td>
<td align="right">0.2887661</td>
<td align="right">0.6723180</td>
<td align="right">0.055</td>
<td align="right">0.9711260</td>
</tr>
<tr class="odd">
<td>KRAS</td>
<td align="right">-0.0673823</td>
<td align="right">0.1926775</td>
<td align="right">0.7269239</td>
<td align="right">0.135</td>
<td align="right">0.9818790</td>
</tr>
<tr class="even">
<td>PIK3CA</td>
<td align="right">-0.0534127</td>
<td align="right">0.2064173</td>
<td align="right">0.7960887</td>
<td align="right">0.115</td>
<td align="right">0.9818790</td>
</tr>
<tr class="odd">
<td>MYC.Amp</td>
<td align="right">0.0692056</td>
<td align="right">0.3021592</td>
<td align="right">0.8190766</td>
<td align="right">0.050</td>
<td align="right">0.9818790</td>
</tr>
<tr class="even">
<td>CDKN2A.Del</td>
<td align="right">-0.0442606</td>
<td align="right">0.2888798</td>
<td align="right">0.8783850</td>
<td align="right">0.055</td>
<td align="right">0.9818790</td>
</tr>
<tr class="odd">
<td>TP53</td>
<td align="right">-0.0153880</td>
<td align="right">0.1319588</td>
<td align="right">0.9072853</td>
<td align="right">0.470</td>
<td align="right">0.9818790</td>
</tr>
<tr class="even">
<td>ARID1A</td>
<td align="right">-0.0161115</td>
<td align="right">0.2581341</td>
<td align="right">0.9502951</td>
<td align="right">0.070</td>
<td align="right">0.9818790</td>
</tr>
<tr class="odd">
<td>NOTCH1</td>
<td align="right">0.0135684</td>
<td align="right">0.2671621</td>
<td align="right">0.9595462</td>
<td align="right">0.065</td>
<td align="right">0.9818790</td>
</tr>
<tr class="even">
<td>MLL2</td>
<td align="right">-0.0058705</td>
<td align="right">0.2581363</td>
<td align="right">0.9818790</td>
<td align="right">0.070</td>
<td align="right">0.9818790</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="no">tab.out</span>$<span class="no">vPlot</span></pre></body></html></div>
<div id="htmlwidget-ac6052d99643cff0dab8" style="width:768px;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-ac6052d99643cff0dab8">{"x":{"visdat":{"d0840eef797":["function () ","plotlyVisDat"]},"cur_data":"d0840eef797","attrs":{"d0840eef797":{"x":{},"y":{},"text":{},"mode":"markers","color":{},"size":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20]}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Volcano Plot","xaxis":{"domain":[0,1],"automargin":true,"title":"Estimate"},"yaxis":{"domain":[0,1],"automargin":true,"title":"-log10(.data$Pvalue)"},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[-0.0153880467741214,-0.379055668968149,-0.0673823257351641,0.251565632107747,-0.15263061287434,-0.50457713454332,-0.0534126905560237,0.207573597577214,0.0135684272587205,-0.00587051946324435,0.160854523234948,-0.0161115008789996,-0.144320469821988,0.70645308671508,0.543238492686134,-0.177916873955994,-0.111901481824652,-0.392769821251894,-0.239201361026593,0.155662676437213,-0.129519583576588,0.122321044462183,-0.271367027913781,-0.044260632135584,-0.301757991706273,0.0692056045237993],"y":[0.0422561176565427,0.766454138614024,0.138511052412042,0.71801942166836,0.24555568401527,1.30283939249894,0.0990385465271865,0.405932669877314,0.0179340880729368,0.00794201721997372,0.272857181496432,0.0221415007428096,0.266435816093429,1.72776294332861,1.14612766381849,0.254643297769975,0.18386680482417,0.806392216137775,0.367695896497227,0.292327079654482,0.174870718604305,0.172425247297193,0.458875035836477,0.0563150961421839,0.587498500188867,0.0866754644265514],"text":["Gene : TP53 <\/br> Estimate : -0.02","Gene : KEAP1 <\/br> Estimate : -0.38","Gene : KRAS <\/br> Estimate : -0.07","Gene : TERT <\/br> Estimate : 0.25","Gene : MLL3 <\/br> Estimate : -0.15","Gene : RB1 <\/br> Estimate : -0.5","Gene : PIK3CA <\/br> Estimate : -0.05","Gene : FAT1 <\/br> Estimate : 0.21","Gene : NOTCH1 <\/br> Estimate : 0.01","Gene : MLL2 <\/br> Estimate : -0.01","Gene : NF1 <\/br> Estimate : 0.16","Gene : ARID1A <\/br> Estimate : -0.02","Gene : EGFR <\/br> Estimate : -0.14","Gene : CREBBP <\/br> Estimate : 0.71","Gene : BRAF <\/br> Estimate : 0.54","Gene : ATM <\/br> Estimate : -0.18","Gene : ATRX <\/br> Estimate : -0.11","Gene : STK11 <\/br> Estimate : -0.39","Gene : SMARCA4 <\/br> Estimate : -0.24","Gene : APC <\/br> Estimate : 0.16","Gene : PTEN <\/br> Estimate : -0.13","Gene : CDKN2A <\/br> Estimate : 0.12","Gene : CCND1.Amp <\/br> Estimate : -0.27","Gene : CDKN2A.Del <\/br> Estimate : -0.04","Gene : MCL1.Amp <\/br> Estimate : -0.3","Gene : MYC.Amp <\/br> Estimate : 0.07"],"mode":"markers","type":"scatter","marker":{"colorbar":{"title":"Estimate","ticklen":2},"cmin":-0.50457713454332,"cmax":0.70645308671508,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"color":[-0.0153880467741214,-0.379055668968149,-0.0673823257351641,0.251565632107747,-0.15263061287434,-0.50457713454332,-0.0534126905560237,0.207573597577214,0.0135684272587205,-0.00587051946324435,0.160854523234948,-0.0161115008789996,-0.144320469821988,0.70645308671508,0.543238492686134,-0.177916873955994,-0.111901481824652,-0.392769821251894,-0.239201361026593,0.155662676437213,-0.129519583576588,0.122321044462183,-0.271367027913781,-0.044260632135584,-0.301757991706273,0.0692056045237993],"size":[100,12.1428571428571,28.2142857142857,28.2142857142857,13.2142857142857,14.2857142857143,23.9285714285714,16.4285714285714,13.2142857142857,14.2857142857143,14.2857142857143,14.2857142857143,17.5,10,10,10,15.3571428571429,12.1428571428571,10,17.5,10,11.0714285714286,11.0714285714286,11.0714285714286,13.2142857142857,10],"sizemode":"area","line":{"colorbar":{"title":"","ticklen":2},"cmin":-0.50457713454332,"cmax":0.70645308671508,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"color":[-0.0153880467741214,-0.379055668968149,-0.0673823257351641,0.251565632107747,-0.15263061287434,-0.50457713454332,-0.0534126905560237,0.207573597577214,0.0135684272587205,-0.00587051946324435,0.160854523234948,-0.0161115008789996,-0.144320469821988,0.70645308671508,0.543238492686134,-0.177916873955994,-0.111901481824652,-0.392769821251894,-0.239201361026593,0.155662676437213,-0.129519583576588,0.122321044462183,-0.271367027913781,-0.044260632135584,-0.301757991706273,0.0692056045237993]}},"textfont":{"size":[100,12.1428571428571,28.2142857142857,28.2142857142857,13.2142857142857,14.2857142857143,23.9285714285714,16.4285714285714,13.2142857142857,14.2857142857143,14.2857142857143,14.2857142857143,17.5,10,10,10,15.3571428571429,12.1428571428571,10,17.5,10,11.0714285714286,11.0714285714286,11.0714285714286,13.2142857142857,10]},"error_y":{"width":[]},"error_x":{"width":[]},"xaxis":"x","yaxis":"y","frame":null},{"x":[-0.50457713454332,0.70645308671508],"y":[0.00794201721997372,1.72776294332861],"type":"scatter","mode":"markers","opacity":0,"hoverinfo":"none","showlegend":false,"marker":{"colorbar":{"title":"Estimate","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"cmin":-0.50457713454332,"cmax":0.70645308671508,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"color":[-0.50457713454332,0.70645308671508],"line":{"color":"rgba(255,127,14,1)"}},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="time-to-event-outcome" class="section level2">
<h2 class="hasAnchor">
<a href="#time-to-event-outcome" class="anchor"></a>Time to event outcome</h2>
<p>We further include <code>uni.cox</code> for univariate survival analysis if time to event data is available. This function takes as inputs:</p>
<ul>
<li>X : a data frame containing the covariates to be used</li>
<li>surv.dat : a data frame containing the time and status information</li>
<li>surv.formula : survival formula of the form <code>Surv(time,status)~.</code> . Note that delayed entry is allowed of the form <code>Surv(time1,time2,status)~.</code>
</li>
<li>filter : a value in [0,1) that will remove all genes that have a frequency below that threshold. Default is 0, including all</li>
</ul>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="no">surv.dat</span> <span class="kw">&lt;-</span> <span class="no">clin.patients</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">X.Patient.Identifier</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/abbreviate.html">abbreviate</a></span>(<span class="no">patients</span>,<span class="kw">strict</span> <span class="kw">=</span> <span class="no">T</span>, <span class="kw">minlength</span> <span class="kw">=</span> <span class="fl">9</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">select</span>(<span class="no">X.Patient.Identifier</span>,<span class="no">Overall.Survival..Months.</span>, <span class="no">Overall.Survival.Status</span>) <span class="kw">%&gt;%</span>
  <span class="fu">rename</span>(<span class="kw">DMPID</span> <span class="kw">=</span> <span class="no">X.Patient.Identifier</span>, <span class="kw">time</span> <span class="kw">=</span> <span class="no">Overall.Survival..Months.</span>,<span class="kw">status</span> <span class="kw">=</span> <span class="no">Overall.Survival.Status</span>) <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">time</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">time</span>)),
    <span class="kw">status</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="no">status</span> <span class="kw">==</span> <span class="st">"LIVING"</span>,<span class="fl">0</span>,<span class="fl">1</span>)) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(!<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">time</span>))
<span class="no">X</span> <span class="kw">&lt;-</span> <span class="no">bin.mut</span>[<span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span>(<span class="no">surv.dat</span>$<span class="no">DMPID</span>,<span class="fu"><a href="https://rdrr.io/r/base/abbreviate.html">abbreviate</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">bin.mut</span>),<span class="kw">strict</span> <span class="kw">=</span> <span class="no">T</span>, <span class="kw">minlength</span> <span class="kw">=</span> <span class="fl">9</span>)),]
<span class="no">surv.test</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/uni.cox.html">uni.cox</a></span>(<span class="kw">X</span> <span class="kw">=</span> <span class="no">X</span>, <span class="kw">surv.dat</span> <span class="kw">=</span> <span class="no">surv.dat</span>,<span class="kw">surv.formula</span> <span class="kw">=</span> <span class="fu">Surv</span>(<span class="no">time</span>,<span class="no">status</span>)~<span class="no">.</span>,<span class="kw">filter</span> <span class="kw">=</span> <span class="fl">0.05</span>)
<span class="fu">kable</span>(<span class="no">surv.test</span>$<span class="no">tab</span>,<span class="kw">row.names</span> <span class="kw">=</span> <span class="no">T</span>)</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="right">Coefficient</th>
<th align="right">Pvalue</th>
<th align="right">MutationFrequency</th>
<th align="left">Feature</th>
<th align="right">FDR</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>EGFR</td>
<td align="right">0.8401699</td>
<td align="right">0.0082134</td>
<td align="right">0.1000000</td>
<td align="left">EGFR</td>
<td align="right">0.2710428</td>
</tr>
<tr class="even">
<td>MLL</td>
<td align="right">0.9437175</td>
<td align="right">0.0196326</td>
<td align="right">0.0642857</td>
<td align="left">MLL</td>
<td align="right">0.2876587</td>
</tr>
<tr class="odd">
<td>RB1</td>
<td align="right">0.7210785</td>
<td align="right">0.0348311</td>
<td align="right">0.0928571</td>
<td align="left">RB1</td>
<td align="right">0.2876587</td>
</tr>
<tr class="even">
<td>CREBBP</td>
<td align="right">0.9020524</td>
<td align="right">0.0348677</td>
<td align="right">0.0571429</td>
<td align="left">CREBBP</td>
<td align="right">0.2876587</td>
</tr>
<tr class="odd">
<td>MLL2</td>
<td align="right">0.5629886</td>
<td align="right">0.0858822</td>
<td align="right">0.1000000</td>
<td align="left">MLL2</td>
<td align="right">0.3788785</td>
</tr>
<tr class="even">
<td>TP53</td>
<td align="right">0.4002848</td>
<td align="right">0.0878174</td>
<td align="right">0.4428571</td>
<td align="left">TP53</td>
<td align="right">0.3788785</td>
</tr>
<tr class="odd">
<td>MYC.Amp</td>
<td align="right">0.7852242</td>
<td align="right">0.0911242</td>
<td align="right">0.0571429</td>
<td align="left">MYC.Amp</td>
<td align="right">0.3788785</td>
</tr>
<tr class="even">
<td>ATRX</td>
<td align="right">-1.2090534</td>
<td align="right">0.0918493</td>
<td align="right">0.0714286</td>
<td align="left">ATRX</td>
<td align="right">0.3788785</td>
</tr>
<tr class="odd">
<td>NF1</td>
<td align="right">0.6239888</td>
<td align="right">0.1478971</td>
<td align="right">0.0642857</td>
<td align="left">NF1</td>
<td align="right">0.5199551</td>
</tr>
<tr class="even">
<td>KRAS</td>
<td align="right">0.4828027</td>
<td align="right">0.1575622</td>
<td align="right">0.1285714</td>
<td align="left">KRAS</td>
<td align="right">0.5199551</td>
</tr>
<tr class="odd">
<td>CDH1</td>
<td align="right">-0.9721043</td>
<td align="right">0.1753208</td>
<td align="right">0.0571429</td>
<td align="left">CDH1</td>
<td align="right">0.5259623</td>
</tr>
<tr class="even">
<td>CDKN2A.Del</td>
<td align="right">0.5532080</td>
<td align="right">0.1949712</td>
<td align="right">0.0571429</td>
<td align="left">CDKN2A.Del</td>
<td align="right">0.5361709</td>
</tr>
<tr class="odd">
<td>APC</td>
<td align="right">-0.6502406</td>
<td align="right">0.2703694</td>
<td align="right">0.0714286</td>
<td align="left">APC</td>
<td align="right">0.6748753</td>
</tr>
<tr class="even">
<td>KEAP1</td>
<td align="right">0.4201128</td>
<td align="right">0.2914466</td>
<td align="right">0.0785714</td>
<td align="left">KEAP1</td>
<td align="right">0.6748753</td>
</tr>
<tr class="odd">
<td>PTEN</td>
<td align="right">-0.6007435</td>
<td align="right">0.3086919</td>
<td align="right">0.0571429</td>
<td align="left">PTEN</td>
<td align="right">0.6748753</td>
</tr>
<tr class="even">
<td>CCND1.Amp</td>
<td align="right">0.4060972</td>
<td align="right">0.3414219</td>
<td align="right">0.0642857</td>
<td align="left">CCND1.Amp</td>
<td align="right">0.6748753</td>
</tr>
<tr class="odd">
<td>TERT</td>
<td align="right">0.2974963</td>
<td align="right">0.3476630</td>
<td align="right">0.1357143</td>
<td align="left">TERT</td>
<td align="right">0.6748753</td>
</tr>
<tr class="even">
<td>MCL1.Amp</td>
<td align="right">-0.2840109</td>
<td align="right">0.5811640</td>
<td align="right">0.0571429</td>
<td align="left">MCL1.Amp</td>
<td align="right">0.9392426</td>
</tr>
<tr class="odd">
<td>EPHA5</td>
<td align="right">-0.2675129</td>
<td align="right">0.6030854</td>
<td align="right">0.0642857</td>
<td align="left">EPHA5</td>
<td align="right">0.9392426</td>
</tr>
<tr class="even">
<td>PIK3CA</td>
<td align="right">0.1598203</td>
<td align="right">0.6705545</td>
<td align="right">0.1071429</td>
<td align="left">PIK3CA</td>
<td align="right">0.9392426</td>
</tr>
<tr class="odd">
<td>NOTCH1</td>
<td align="right">-0.2126047</td>
<td align="right">0.6794263</td>
<td align="right">0.0714286</td>
<td align="left">NOTCH1</td>
<td align="right">0.9392426</td>
</tr>
<tr class="even">
<td>FGF19.Amp</td>
<td align="right">0.2103654</td>
<td align="right">0.6830855</td>
<td align="right">0.0500000</td>
<td align="left">FGF19.Amp</td>
<td align="right">0.9392426</td>
</tr>
<tr class="odd">
<td>FGF3.Amp</td>
<td align="right">0.2103654</td>
<td align="right">0.6830855</td>
<td align="right">0.0500000</td>
<td align="left">FGF3.Amp</td>
<td align="right">0.9392426</td>
</tr>
<tr class="even">
<td>FGF4.Amp</td>
<td align="right">0.2103654</td>
<td align="right">0.6830855</td>
<td align="right">0.0500000</td>
<td align="left">FGF4.Amp</td>
<td align="right">0.9392426</td>
</tr>
<tr class="odd">
<td>SMARCA4</td>
<td align="right">-0.1835278</td>
<td align="right">0.7212676</td>
<td align="right">0.0642857</td>
<td align="left">SMARCA4</td>
<td align="right">0.9520733</td>
</tr>
<tr class="even">
<td>ARID1A</td>
<td align="right">0.1159495</td>
<td align="right">0.7858943</td>
<td align="right">0.0785714</td>
<td align="left">ARID1A</td>
<td align="right">0.9957052</td>
</tr>
<tr class="odd">
<td>POLE</td>
<td align="right">-0.1183010</td>
<td align="right">0.8411886</td>
<td align="right">0.0500000</td>
<td align="left">POLE</td>
<td align="right">0.9957052</td>
</tr>
<tr class="even">
<td>FAT1</td>
<td align="right">-0.0667120</td>
<td align="right">0.8667995</td>
<td align="right">0.1071429</td>
<td align="left">FAT1</td>
<td align="right">0.9957052</td>
</tr>
<tr class="odd">
<td>MLL3</td>
<td align="right">-0.0620558</td>
<td align="right">0.8935273</td>
<td align="right">0.0642857</td>
<td align="left">MLL3</td>
<td align="right">0.9957052</td>
</tr>
<tr class="even">
<td>STK11</td>
<td align="right">0.0200173</td>
<td align="right">0.9625480</td>
<td align="right">0.0857143</td>
<td align="left">STK11</td>
<td align="right">0.9957052</td>
</tr>
<tr class="odd">
<td>PTPRT</td>
<td align="right">-0.0143308</td>
<td align="right">0.9777833</td>
<td align="right">0.0500000</td>
<td align="left">PTPRT</td>
<td align="right">0.9957052</td>
</tr>
<tr class="even">
<td>ATM</td>
<td align="right">0.0129360</td>
<td align="right">0.9778095</td>
<td align="right">0.0714286</td>
<td align="left">ATM</td>
<td align="right">0.9957052</td>
</tr>
<tr class="odd">
<td>BRCA2</td>
<td align="right">-18.1637163</td>
<td align="right">0.9957052</td>
<td align="right">0.0500000</td>
<td align="left">BRCA2</td>
<td align="right">0.9957052</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="no">surv.test</span>$<span class="no">p</span></pre></body></html></div>
<div id="htmlwidget-667e65fcb3cfa1dceca2" style="width:768px;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-667e65fcb3cfa1dceca2">{"x":{"visdat":{"d0835d3d786":["function () ","plotlyVisDat"]},"cur_data":"d0835d3d786","attrs":{"d0835d3d786":{"x":{},"y":{},"text":{},"mode":"markers","color":{},"size":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20]}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Volcano Plot","xaxis":{"domain":[0,1],"automargin":true,"title":"Coefficient"},"yaxis":{"domain":[0,1],"automargin":true,"title":"-log10(Pvalue)"},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[0.840169936352045,0.943717480265381,0.721078547408767,0.902052383767825,0.562988613518701,0.400284846902155,0.785224206381538,-1.20905336573811,0.623988815093702,0.482802687090521,-0.972104251400818,0.553207976441449,-0.65024059441998,0.420112774928169,-0.600743544310261,0.406097213140529,0.297496329121659,-0.284010868120827,-0.267512941055254,0.159820290602767,-0.212604719756198,0.21036541569408,0.21036541569408,0.21036541569408,-0.183527767323415,0.115949542186144,-0.118300965626929,-0.0667119678564476,-0.0620558168820538,0.020017283240682,-0.0143308458668488,0.0129360446572344,-18.1637162595652],"y":[2.08547608322997,1.70702315211632,1.45803281218591,1.45757649641832,1.06609671579447,1.05641921943643,1.04036637863823,1.03692399330372,0.830040241736948,0.802548081138468,0.756166619377424,0.710029464828527,0.568042505400961,0.535440951563223,0.510474706109456,0.466708603933581,0.45884147846294,0.235701315082536,0.219621156727298,0.173565916124466,0.167857669153027,0.165524927138777,0.165524927138777,0.165524927138777,0.141903546980609,0.104635870102438,0.0751066002346599,0.0620813475041945,0.0488921661985758,0.0165776028354638,0.009757374775214,0.00974576015617915,0.00186923435593439],"text":["Feature : EGFR <br> Hazard Ratio : 2.317","Feature : MLL <br> Hazard Ratio : 2.57","Feature : RB1 <br> Hazard Ratio : 2.057","Feature : CREBBP <br> Hazard Ratio : 2.465","Feature : MLL2 <br> Hazard Ratio : 1.756","Feature : TP53 <br> Hazard Ratio : 1.492","Feature : MYC.Amp <br> Hazard Ratio : 2.193","Feature : ATRX <br> Hazard Ratio : 0.298","Feature : NF1 <br> Hazard Ratio : 1.866","Feature : KRAS <br> Hazard Ratio : 1.621","Feature : CDH1 <br> Hazard Ratio : 0.378","Feature : CDKN2A.Del <br> Hazard Ratio : 1.739","Feature : APC <br> Hazard Ratio : 0.522","Feature : KEAP1 <br> Hazard Ratio : 1.522","Feature : PTEN <br> Hazard Ratio : 0.548","Feature : CCND1.Amp <br> Hazard Ratio : 1.501","Feature : TERT <br> Hazard Ratio : 1.346","Feature : MCL1.Amp <br> Hazard Ratio : 0.753","Feature : EPHA5 <br> Hazard Ratio : 0.765","Feature : PIK3CA <br> Hazard Ratio : 1.173","Feature : NOTCH1 <br> Hazard Ratio : 0.808","Feature : FGF19.Amp <br> Hazard Ratio : 1.234","Feature : FGF3.Amp <br> Hazard Ratio : 1.234","Feature : FGF4.Amp <br> Hazard Ratio : 1.234","Feature : SMARCA4 <br> Hazard Ratio : 0.832","Feature : ARID1A <br> Hazard Ratio : 1.123","Feature : POLE <br> Hazard Ratio : 0.888","Feature : FAT1 <br> Hazard Ratio : 0.935","Feature : MLL3 <br> Hazard Ratio : 0.94","Feature : STK11 <br> Hazard Ratio : 1.02","Feature : PTPRT <br> Hazard Ratio : 0.986","Feature : ATM <br> Hazard Ratio : 1.013","Feature : BRCA2 <br> Hazard Ratio : 0"],"mode":"markers","type":"scatter","marker":{"colorbar":{"title":"MutationFrequency","ticklen":2},"cmin":0.05,"cmax":0.442857142857143,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333334","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"color":[0.1,0.0642857142857143,0.0928571428571429,0.0571428571428571,0.1,0.442857142857143,0.0571428571428571,0.0714285714285714,0.0642857142857143,0.128571428571429,0.0571428571428571,0.0571428571428571,0.0714285714285714,0.0785714285714286,0.0571428571428571,0.0642857142857143,0.135714285714286,0.0571428571428571,0.0642857142857143,0.107142857142857,0.0714285714285714,0.05,0.05,0.05,0.0642857142857143,0.0785714285714286,0.05,0.107142857142857,0.0642857142857143,0.0857142857142857,0.05,0.0714285714285714,0.05],"size":[21.4545454545455,13.2727272727273,19.8181818181818,11.6363636363636,21.4545454545455,100,11.6363636363636,14.9090909090909,13.2727272727273,28,11.6363636363636,11.6363636363636,14.9090909090909,16.5454545454545,11.6363636363636,13.2727272727273,29.6363636363636,11.6363636363636,13.2727272727273,23.0909090909091,14.9090909090909,10,10,10,13.2727272727273,16.5454545454545,10,23.0909090909091,13.2727272727273,18.1818181818182,10,14.9090909090909,10],"sizemode":"area","line":{"colorbar":{"title":"","ticklen":2},"cmin":0.05,"cmax":0.442857142857143,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333334","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"color":[0.1,0.0642857142857143,0.0928571428571429,0.0571428571428571,0.1,0.442857142857143,0.0571428571428571,0.0714285714285714,0.0642857142857143,0.128571428571429,0.0571428571428571,0.0571428571428571,0.0714285714285714,0.0785714285714286,0.0571428571428571,0.0642857142857143,0.135714285714286,0.0571428571428571,0.0642857142857143,0.107142857142857,0.0714285714285714,0.05,0.05,0.05,0.0642857142857143,0.0785714285714286,0.05,0.107142857142857,0.0642857142857143,0.0857142857142857,0.05,0.0714285714285714,0.05]}},"textfont":{"size":[21.4545454545455,13.2727272727273,19.8181818181818,11.6363636363636,21.4545454545455,100,11.6363636363636,14.9090909090909,13.2727272727273,28,11.6363636363636,11.6363636363636,14.9090909090909,16.5454545454545,11.6363636363636,13.2727272727273,29.6363636363636,11.6363636363636,13.2727272727273,23.0909090909091,14.9090909090909,10,10,10,13.2727272727273,16.5454545454545,10,23.0909090909091,13.2727272727273,18.1818181818182,10,14.9090909090909,10]},"error_y":{"width":[]},"error_x":{"width":[]},"xaxis":"x","yaxis":"y","frame":null},{"x":[-18.1637162595652,0.943717480265381],"y":[0.00186923435593439,2.08547608322997],"type":"scatter","mode":"markers","opacity":0,"hoverinfo":"none","showlegend":false,"marker":{"colorbar":{"title":"MutationFrequency","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"cmin":0.05,"cmax":0.442857142857143,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333334","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"color":[0.05,0.442857142857143],"line":{"color":"rgba(255,127,14,1)"}},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb28"><html><body><pre class="r"><span class="no">surv.test</span>$<span class="no">KM</span>
<span class="co">#&gt; [[1]]</span></pre></body></html></div>
<p><img src="gnomeR-vignette_files/figure-html/unnamed-chunk-14-2.png" width="768"></p>
<pre><code>#&gt; 
#&gt; [[2]]</code></pre>
<p><img src="gnomeR-vignette_files/figure-html/unnamed-chunk-14-3.png" width="768"></p>
<pre><code>#&gt; 
#&gt; [[3]]</code></pre>
<p><img src="gnomeR-vignette_files/figure-html/unnamed-chunk-14-4.png" width="768"></p>
<pre><code>#&gt; 
#&gt; [[4]]</code></pre>
<p><img src="gnomeR-vignette_files/figure-html/unnamed-chunk-14-5.png" width="768"></p>
<pre><code>#&gt; 
#&gt; [[5]]</code></pre>
<p><img src="gnomeR-vignette_files/figure-html/unnamed-chunk-14-6.png" width="768"></p>
<pre><code>#&gt; 
#&gt; [[6]]</code></pre>
<p><img src="gnomeR-vignette_files/figure-html/unnamed-chunk-14-7.png" width="768"></p>
<pre><code>#&gt; 
#&gt; [[7]]</code></pre>
<p><img src="gnomeR-vignette_files/figure-html/unnamed-chunk-14-8.png" width="768"></p>
<pre><code>#&gt; 
#&gt; [[8]]</code></pre>
<p><img src="gnomeR-vignette_files/figure-html/unnamed-chunk-14-9.png" width="768"></p>
<pre><code>#&gt; 
#&gt; [[9]]</code></pre>
<p><img src="gnomeR-vignette_files/figure-html/unnamed-chunk-14-10.png" width="768"></p>
<pre><code>#&gt; 
#&gt; [[10]]</code></pre>
<p><img src="gnomeR-vignette_files/figure-html/unnamed-chunk-14-11.png" width="768"></p>
</div>
</div>
<div id="advanced-genetic-visuals" class="section level1">
<h1 class="hasAnchor">
<a href="#advanced-genetic-visuals" class="anchor"></a>Advanced genetic visuals</h1>
<div id="oncoprints" class="section level2">
<h2 class="hasAnchor">
<a href="#oncoprints" class="anchor"></a>OncoPrints</h2>
<p>OncoPrints are a convenient way to study comutation patterns in our cohort through the <code>plot_oncoPrint</code> function. It takes as argument:</p>
<ul>
<li>gen.dat : data frame of binary genetic events as created by the <code>binmat</code> function</li>
<li>clin.patients.dat : optional data frame of clin.patientsical covariates</li>
<li>ordered : order in which patients should be printed in the OncoPrint</li>
</ul>
<p>We show here an example with the most common genes.</p>
<div class="sourceCode" id="cb38"><html><body><pre class="r"><span class="no">gen.dat</span> <span class="kw">&lt;-</span> <span class="no">bin.mut</span>[,<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(<span class="no">bin.mut</span>,<span class="fl">2</span>, <span class="no">sum</span>),<span class="kw">decreasing</span> <span class="kw">=</span> <span class="no">T</span>))[<span class="fl">1</span>:<span class="fl">15</span>]]
<span class="fu"><a href="../reference/plot_oncoPrint.html">plot_oncoPrint</a></span>(<span class="no">gen.dat</span>)</pre></body></html></div>
<p><img src="gnomeR-vignette_files/figure-html/unnamed-chunk-15-1.png" width="768"></p>
<p>Similarly we include here an example adding patients’ clinical variables:</p>
<div class="sourceCode" id="cb39"><html><body><pre class="r"><span class="no">clin.patients.dat</span> <span class="kw">&lt;-</span> <span class="no">clin.patients</span>[<span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/abbreviate.html">abbreviate</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">gen.dat</span>),<span class="kw">strict</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">minlength</span> <span class="kw">=</span> <span class="fl">9</span>),<span class="no">clin.patients</span>$<span class="no">X.Patient.Identifier</span>),] <span class="kw">%&gt;%</span>
  <span class="fu">rename</span>(<span class="kw">DMPID</span> <span class="kw">=</span> <span class="no">X.Patient.Identifier</span>, <span class="kw">Smoker</span> <span class="kw">=</span> <span class="no">Smoking.History</span>) <span class="kw">%&gt;%</span>
  <span class="fu">select</span>(<span class="no">DMPID</span>, <span class="no">Sex</span>,<span class="no">Smoker</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(!<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">DMPID</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">distinct</span>(<span class="no">DMPID</span>,<span class="kw">.keep_all</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">gen.dat</span> <span class="kw">&lt;-</span> <span class="no">gen.dat</span>[<span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span>(<span class="no">clin.patients.dat</span>$<span class="no">DMPID</span>,<span class="fu"><a href="https://rdrr.io/r/base/abbreviate.html">abbreviate</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">gen.dat</span>),<span class="kw">strict</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">minlength</span> <span class="kw">=</span> <span class="fl">9</span>)),]
<span class="no">clin.patients.dat</span> <span class="kw">&lt;-</span> <span class="no">clin.patients.dat</span> <span class="kw">%&gt;%</span>
  <span class="kw pkg">tibble</span><span class="kw ns">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">column_to_rownames</a></span>(<span class="st">'DMPID'</span>)
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">gen.dat</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">clin.patients.dat</span>)
<span class="fu"><a href="../reference/plot_oncoPrint.html">plot_oncoPrint</a></span>(<span class="kw">gen.dat</span> <span class="kw">=</span> <span class="no">gen.dat</span>,<span class="kw">clin.dat</span> <span class="kw">=</span> <span class="no">clin.patients.dat</span>)</pre></body></html></div>
<p><img src="gnomeR-vignette_files/figure-html/unnamed-chunk-16-1.png" width="768"></p>
</div>
<div id="facets" class="section level2">
<h2 class="hasAnchor">
<a href="#facets" class="anchor"></a>FACETs</h2>
<p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5027494/">FACETs</a> is a fully integrated stand-alone pipeline that includes sequencing BAM file post-processing, joint segmentation of total- and allele-specific read counts, and integer copy number calls corrected for tumor purity, ploidy and clonal heterogeneity, with comprehensive output and integrated visualization. We integrate the output of this tool to our package to visualise the copy number alteration events in our cohort. The segmentation file is now integrated to the cBioPortal and we include it in our package. The FACETs output can be visualised using the <code>facets.heatmap</code> function which takes as input:</p>
<ul>
<li>seg : a segmentation file containing all the samples of interest</li>
<li>filenames : character vector of file names in case you are given individual segmentation files for each patients</li>
<li>path : the path to the files of the filenames character vector</li>
<li>patients : DMPIDs of the samples to be included in the heatmap. Default is NULL where all patients will be used</li>
<li>min.purity : if filenames argument is provided you may select a minimum purity to be included in the heatmap. Default is 0.3</li>
<li>epsilon : the maximum Euclidean distance between adjacent probes tolerated for denying a nonredundant region. epsilon=0 is equivalent to taking the union of all unique break points across the n samples. See CNregions function iClusterPlus for more information. Default is 0.005</li>
<li>ordered : order in which patients should be printed in the heatmap. Default is NULL, where we use hierarchical clustering.</li>
<li>outcome : potential outcome of interest to be plotted along the X-axis</li>
</ul>
<p>This function returns the a heatmap and the merged segmentation dataset used to created:</p>
<div class="sourceCode" id="cb40"><html><body><pre class="r"><span class="no">patients.seg</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="no">clin.sample</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">Sample.Identifier</span> <span class="kw">%in%</span> <span class="no">patients</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">Tumor.Purity</span>)) <span class="kw">&gt;</span> <span class="fl">30</span>) <span class="kw">%&gt;%</span> <span class="fu">select</span>(<span class="no">Sample.Identifier</span>)))
<span class="no">facet</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/facets.heatmap.html">facets.heatmap</a></span>(<span class="kw">seg</span> <span class="kw">=</span> <span class="no">seg</span>, <span class="kw">patients</span><span class="kw">=</span><span class="no">patients.seg</span>[<span class="fl">0</span>:<span class="fl">100</span>])
<span class="no">facet</span>$<span class="no">p</span></pre></body></html></div>
<p><img src="gnomeR-vignette_files/figure-html/unnamed-chunk-17-1.png" width="768"></p>
<div class="sourceCode" id="cb41"><html><body><pre class="r"><span class="fu">as.tbl</span>(<span class="no">facet</span>$<span class="no">out.cn</span>)
<span class="co">#&gt; # A tibble: 100 x 610</span>
<span class="co">#&gt;    `chr1.2488138-1… `chr1.11167550-… `chr1.14192672-… `chr1.15296019-…</span>
<span class="co">#&gt;               &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;</span>
<span class="co">#&gt;  1           0.0326           0.0326           0.0326           0.0326</span>
<span class="co">#&gt;  2          -0.0198          -0.0198          -0.0198          -0.0198</span>
<span class="co">#&gt;  3           0.0939           0.0939           0.0939           0.0939</span>
<span class="co">#&gt;  4          -0.155            0.0092           0.0092           0.0092</span>
<span class="co">#&gt;  5          -0.029           -0.029           -0.029           -0.029 </span>
<span class="co">#&gt;  6           0.0431           0.0431           0.0431           0.0431</span>
<span class="co">#&gt;  7           0.113            0.113            0.113            0.113 </span>
<span class="co">#&gt;  8          -0.408           -0.0501          -0.0501          -0.0501</span>
<span class="co">#&gt;  9          -0.0555          -0.0555          -0.0555          -0.0555</span>
<span class="co">#&gt; 10          -0.0391          -0.0391          -0.0391          -0.0391</span>
<span class="co">#&gt; # … with 90 more rows, and 606 more variables: `chr1.16199471-16235896` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr1.16235896-17345415` &lt;dbl&gt;, `chr1.17345415-22587878` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr1.22587878-30535114` &lt;dbl&gt;, `chr1.30535114-35013586` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr1.35013586-35468429` &lt;dbl&gt;, `chr1.35468429-36411737` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr1.36411737-45795044` &lt;dbl&gt;, `chr1.45795044-51434461` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr1.51434461-59564373` &lt;dbl&gt;, `chr1.59564373-65300293` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr1.65300293-65301840` &lt;dbl&gt;, `chr1.65301840-66042078` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr1.66042078-70742063` &lt;dbl&gt;, `chr1.70742063-82939537` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr1.82939537-96258925` &lt;dbl&gt;, `chr1.96258925-99589424` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr1.99589424-108079945` &lt;dbl&gt;, `chr1.108079945-113234456` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr1.113234456-117273534` &lt;dbl&gt;, `chr1.117273534-118145461` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr1.118145461-118223984` &lt;dbl&gt;, `chr1.118223984-120199189` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr1.120199189-120491113` &lt;dbl&gt;, `chr1.120491113-120572570` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr1.120572570-120611984` &lt;dbl&gt;, `chr1.120611984-147282446` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr1.147282446-152330945` &lt;dbl&gt;, `chr1.152330945-155870294` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr1.155870294-156785626` &lt;dbl&gt;, `chr1.156785626-161284206` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr1.161284206-162688895` &lt;dbl&gt;, `chr1.162688895-169022903` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr1.169022903-175914298` &lt;dbl&gt;, `chr1.175914298-176175911` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr1.176175911-180810233` &lt;dbl&gt;, `chr1.180810233-185520600` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr1.185520600-193094295` &lt;dbl&gt;, `chr1.193094295-202188641` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr1.202188641-204494686` &lt;dbl&gt;, `chr1.204494686-206646614` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr1.206646614-206942027` &lt;dbl&gt;, `chr1.206942027-209632563` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr1.209632563-219991341` &lt;dbl&gt;, `chr1.219991341-226064745` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr1.226064745-226549202` &lt;dbl&gt;, `chr1.226549202-226589998` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr1.226589998-234272887` &lt;dbl&gt;, `chr1.234272887-243663067` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr1.243663067-245977996` &lt;dbl&gt;, `chr2.4717089-25100738` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr2.25100738-28539877` &lt;dbl&gt;, `chr2.28539877-29416439` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr2.29416439-34654129` &lt;dbl&gt;, `chr2.34654129-38467258` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr2.38467258-47596683` &lt;dbl&gt;, `chr2.47596683-47600656` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr2.47600656-50178151` &lt;dbl&gt;, `chr2.50178151-60170875` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr2.60170875-61706028` &lt;dbl&gt;, `chr2.61706028-61711156` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr2.61711156-72126420` &lt;dbl&gt;, `chr2.72126420-96919700` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr2.96919700-99136565` &lt;dbl&gt;, `chr2.99136565-99149899` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr2.99149899-99373720` &lt;dbl&gt;, `chr2.99373720-120048729` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr2.120048729-125424612` &lt;dbl&gt;, `chr2.125424612-158739584` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr2.158739584-173914775` &lt;dbl&gt;, `chr2.173914775-178129282` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr2.178129282-185198425` &lt;dbl&gt;, `chr2.185198425-189541688` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr2.189541688-193538820` &lt;dbl&gt;, `chr2.193538820-193562208` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr2.193562208-198257106` &lt;dbl&gt;, `chr2.198257106-198299710` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr2.198299710-202123030` &lt;dbl&gt;, `chr2.202123030-203723989` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr2.203723989-204836598` &lt;dbl&gt;, `chr2.204836598-212248563` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr2.212248563-216768839` &lt;dbl&gt;, `chr2.216768839-217736131` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr2.217736131-242800953` &lt;dbl&gt;, `chr3.1449872-12955982` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr3.12955982-24205251` &lt;dbl&gt;, `chr3.24205251-30733002` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr3.30733002-33432307` &lt;dbl&gt;, `chr3.33432307-37035097` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr3.37035097-37038155` &lt;dbl&gt;, `chr3.37038155-38180336` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr3.38180336-41265566` &lt;dbl&gt;, `chr3.41265566-43177020` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr3.43177020-47058664` &lt;dbl&gt;, `chr3.47058664-59789176` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr3.59789176-69788801` &lt;dbl&gt;, `chr3.69788801-71015124` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr3.71015124-71019922` &lt;dbl&gt;, `chr3.71019922-71064752` &lt;dbl&gt;,</span>
<span class="co">#&gt; #   `chr3.71064752-71247137` &lt;dbl&gt;, …</span></pre></body></html></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Axel Martin, Arshi Arora, Karissa Whiting, Margie Hannum.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
